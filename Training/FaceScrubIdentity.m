(* ::Package:: *)

dataset=Import["C:\\Users\\julian\\ImageDataSets\\FaceScrub\\FaceIdentityTraining.mx"];


training=RandomSample[dataset];


classes=Union[training[[All,2]]];


net=NetInitialize[NetChain[{ConvolutionLayer[16,{5,5}],Tanh,PoolingLayer[2,{3,3}],ConvolutionLayer[32,{3,3}],Tanh,
PoolingLayer[2,{3,3}],ConvolutionLayer[64,{3,3}],FlattenLayer[],Length[classes],SoftmaxLayer[]},
"Output"->NetDecoder[{"Class",classes}],"Input"->NetEncoder[{"Image",{64,64},"RGB"}]]]


TagBox[TagBox[RowBox[{"NetChain",RowBox[{"[",PanelBox[DynamicModuleBox[{NeuralNetworks`Private`NetChain`assoc3=Association["Type"->"Chain","Nodes"->Association["1"->Association["Type"->"Convolution","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{16,3,5,5}],"Biases"->NeuralNetworks`Private`DummyRawArray[{16}]],"Parameters"->Association["OutputChannels"->16,"KernelSize"->{5,5},"Stride"->{1,1},"PaddingSize"->{0,0},"Dilation"->{1,1},"Dimensionality"->2,"InputChannels"->3,"$GroupNumber"->1,"$InputSize"->{64,64},"$OutputSize"->{60,60}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{3,64,64},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]]],"2"->Association["Type"->"Elementwise","Arrays"->Association[],"Parameters"->Association["Function"->NeuralNetworks`ValidatedParameter[Tanh],"$Dimensions"->{16,60,60}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]]],"3"->Association["Type"->"Pooling","Arrays"->Association[],"Parameters"->Association["KernelSize"->{2,2},"Stride"->{3,3},"PaddingSize"->{0,0},"Function"->Max,"Dimensionality"->2,"Channels"->16,"$InputSize"->{60,60},"$OutputSize"->{20,20},"$MXPoolingConvention"->"valid","$MXGlobalPool"->False],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{16,20,20},NeuralNetworks`RealT]]],"4"->Association["Type"->"Convolution","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{32,16,3,3}],"Biases"->NeuralNetworks`Private`DummyRawArray[{32}]],"Parameters"->Association["OutputChannels"->32,"KernelSize"->{3,3},"Stride"->{1,1},"PaddingSize"->{0,0},"Dilation"->{1,1},"Dimensionality"->2,"InputChannels"->16,"$GroupNumber"->1,"$InputSize"->{20,20},"$OutputSize"->{18,18}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{16,20,20},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]]],"5"->Association["Type"->"Elementwise","Arrays"->Association[],"Parameters"->Association["Function"->NeuralNetworks`ValidatedParameter[Tanh],"$Dimensions"->{32,18,18}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]]],"6"->Association["Type"->"Pooling","Arrays"->Association[],"Parameters"->Association["KernelSize"->{2,2},"Stride"->{3,3},"PaddingSize"->{0,0},"Function"->Max,"Dimensionality"->2,"Channels"->32,"$InputSize"->{18,18},"$OutputSize"->{6,6},"$MXPoolingConvention"->"valid","$MXGlobalPool"->False],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{32,6,6},NeuralNetworks`RealT]]],"7"->Association["Type"->"Convolution","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{64,32,3,3}],"Biases"->NeuralNetworks`Private`DummyRawArray[{64}]],"Parameters"->Association["OutputChannels"->64,"KernelSize"->{3,3},"Stride"->{1,1},"PaddingSize"->{0,0},"Dilation"->{1,1},"Dimensionality"->2,"InputChannels"->32,"$GroupNumber"->1,"$InputSize"->{6,6},"$OutputSize"->{4,4}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{32,6,6},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{64,4,4},NeuralNetworks`RealT]]],"8"->Association["Type"->"Flatten","Arrays"->Association[],"Parameters"->Association["Level"->DirectedInfinity[1],"OutputSize"->{1024},"$InputSize"->{64,4,4}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{64,4,4},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{1024},NeuralNetworks`RealT]]],"9"->Association["Type"->"Linear","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{530,1024}],"Biases"->NeuralNetworks`Private`DummyRawArray[{530}]],"Parameters"->Association["OutputDimensions"->{530},"$OutputSize"->530,"$InputSize"->1024,"$InputDimensions"->{1024}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{1024},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]]],"10"->Association["Type"->"Softmax","Arrays"->Association[],"Parameters"->Association[],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]]]],"Edges"->{NeuralNetworks`NetPath["Nodes","1","Inputs","Input"]->NeuralNetworks`NetPath["Inputs","Input"],NeuralNetworks`NetPath["Nodes","2","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","1","Outputs","Output"],NeuralNetworks`NetPath["Nodes","3","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","2","Outputs","Output"],NeuralNetworks`NetPath["Nodes","4","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","3","Outputs","Output"],NeuralNetworks`NetPath["Nodes","5","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","4","Outputs","Output"],NeuralNetworks`NetPath["Nodes","6","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","5","Outputs","Output"],NeuralNetworks`NetPath["Nodes","7","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","6","Outputs","Output"],NeuralNetworks`NetPath["Nodes","8","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","7","Outputs","Output"],NeuralNetworks`NetPath["Nodes","9","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","8","Outputs","Output"],NeuralNetworks`NetPath["Nodes","10","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","9","Outputs","Output"],NeuralNetworks`NetPath["Outputs","Output"]->NeuralNetworks`NetPath["Nodes","10","Outputs","Output"]},"Inputs"->Association["Input"->NetEncoder["Image",Association["ImageSize"->{64,64},"ColorSpace"->"RGB","ColorChannels"->3,"MeanImage"->None,"VarianceImage"->None],NeuralNetworks`TensorT[{3,64,64},NeuralNetworks`RealT]]],"Outputs"->Association["Output"->NetDecoder["Class",Association["Labels"->{"Aaron Eckhart","Adam Brody","Adam McKay","Adam Sandler","Adrianne Le\[OAcute]n","Adrien Brody","Adrienne Barbeau","Adrienne Frantz","Aisha Hinds","Alan Alda","Alan Arkin","Alan Rickman","Alec Baldwin","Alexander Skarsg\[ARing]rd","Alfred Molina","Alice Krige","Alley Mills","Allison Janney","Al Pacino","Alyson Hannigan","Alyssa Milano","Amanda Bearse","Amaury Nolasco","America Ferrera","Amy Davidson","Andrea Anders","Andrea Bogart","Andrea Bowen","Andy Garcia","Andy Richter","Andy Serkis","Angell Conwell","Angie Harmon","Anne Hathaway","Annie Ilonzeh","Anthony Hopkins","Anthony Stewart Head","Antonio Banderas","Arnold Schwarzenegger","Arnold Vosloo","Ashley Benson","Ashley Johnson","Ashley Jones","Ashton Kutcher","Audra McDonald","Audrey Landers","Barbara Carrera","Ben Affleck","Benicio Del Toro","Ben Kingsley","Ben McKenzie","Ben Stiller","Bernard Hill","Bernie Mac","Bill Cosby","Bill Hader","Bill Murray","Bill Nighy","Billy Bob Thornton","Billy Boyd","Billy Burke","Billy Zane","Bobbie Eakes","Bonnie Franklin","Brad Garrett","Bradley Cooper","Brad Pitt","Brendan Fraser","Brianna Brown","Brooke Langton","Bruce Greenwood","Bruce Willis","Burt Reynolds","Calista Flockhart","Cam Gigandet","Candace Cameron Bure","Candice Bergen","Carey Lowell","Carla Gallo","Carmen Electra","Caroline Dhavernas","Carolyn Hennesy","Cary Elwes","Casey Affleck","Catherine Bell","Cathy Lee Crosby","Channing Tatum","Charlie Day","Charlie Sheen","Chase Masterson","Chazz Palminteri","Cheryl Hines","Cheryl Ladd","Chris Evans","Chris Kattan","Chris Klein","Chris Noth","Chris Rock","Christa Miller","Christel Khalil","Christian Bale","Christian Slater","Christina Applegate","Christina Bennett Lind","Christine Lakin","Christopher Lloyd","Christopher Reeve","Chyler Leigh","Ciara Bravo","Clint Eastwood","Clive Owen","Colin Farrell","Colin Firth","Colin Hanks","Courteney Cox","Crystal Bernard","Crystal Chappell","Dana Delany","Danica McKellar","Daniel Craig","Daniel Day-Lewis","Daniel Radcliffe","Dan Lauria","Danny Glover","Danny Masterson","Danny Trejo","David Boreanaz","David Cross","David Duchovny","David Schwimmer","David Wenham","Dean Cain","Debi Mazar","Debra Messing","Delta Burke","Denise Crosby","Denzel Washington","Dermot Mulroney","Desmond Harrington","Diahann Carroll","Dianna Agron","Didi Conn","Diego Luna","Dina Meyer","Dominic Monaghan","Don Cheadle","Drea de Matteo","Dustin Hoffman","Dwayne Johnson","Ed Harris","Edie Falco","Edi Gathegi","Eileen Davidson","Elijah Wood","Elizabeth Berkley","Elizabeth Hendrickson","Eliza Coupe","Eliza Dushku","Ellen DeGeneres","Ellen Greene","Emile Hirsch","Emily Deschanel","Eric Dane","Erin Chambers","Erin Cummings","Ethan Hawke","Eva Longoria","Ewan McGregor","Faith Ford","Farah Fath","Farrah Fawcett","Felicity Huffman","Florencia Lozano","Frances Fisher","Fran Drescher","Freddy Prinze Jr.","Freddy Rodr\[IAcute]guez","Gabrielle Carteris","Gabriel Macht","Gary Dourdan","Gary Oldman","Gates McFadden","Geena Davis","Gene Hackman","Geoffrey Rush","George Clooney","George Lopez","Gerard Butler","Gillian Anderson","Giovanni Ribisi","Glenn Close","Hal Holbrook","Hank Azaria","Harrison Ford","Harry Connick Jr.","Hayden Christensen","Heather Locklear","Heath Ledger","Hector Elizondo","Helen Hunt","Holly Marie Combs","Hugh Grant","Hugh Jackman","Hugo Weaving","Ian Holm","Ian McKellen","Ilene Kristen","Ioan Gruffudd","Jackee Harry","Jackie Chan","Jack Nicholson","Jackson Rathbone","Jaden Smith","Jake Gyllenhaal","Jake Weber","James Brolin","James Frain","James Franco","James Marsden","James McAvoy","James Remar","Jamie Foxx","Jamie Lee Curtis","Jamie Luner","Jane Curtin","Jane Krakowski","Jane Leeves","Jane Lynch","January Jones","Jared Padalecki","Jasmine Guy","Jason Bateman","Jason Behr","Jason Biggs","Jason Lee","Jason Statham","Jason Sudeikis","Jay Baruchel","Jean-Claude Van Damme","Jeanne Cooper","Jean Reno","Jeffrey Tambor","Jenilee Harrison","Jennette McCurdy","Jennie Garth","Jennifer Aniston","Jennifer Gareis","Jennifer Love Hewitt","Jensen Ackles","Jeremy Irons","Jeremy Sisto","Jerry Seinfeld","Jesse Eisenberg","Jessica Biel","Jessica Capshaw","Jessica Leccia","Jet Li","Jill Eikenberry","Jill Hennessy","Jim Beaver","Jim Carrey","Jim Caviezel","Jimmy Fallon","J.K. Simmons","Joan Collins","Joanna Garc\[IAcute]a","Joanna Kerns","Joaquin Phoenix","Jodi Long","Joe Manganiello","Joe Pantoliano","John Cleese","John Cusack","John Krasinski","John Malkovich","John Noble","Johnny Depp","John Travolta","Jolene Blalock","Jonah Hill","Jonathan Rhys Meyers","Jonathan Sadowski","Jon Hamm","Jon Voight","Josh Brolin","Josh Duhamel","Josh Hartnett","Joshua Jackson","Josie Bissett","Joyce DeWitt","Jude Law","Judi Evans","Judith Light","Julia Louis-Dreyfus","Julianna Margulies","Julie Benz","Julie Bowen","Julie Marie Berman","Justine Bateman","Justin Long","Justin Timberlake","Kaley Cuoco","Kal Penn","Karl Urban","Kassie DePaiva","Kate Linder","Katherine Helmond","Katherine Kelly Lang","Kathryn Joosten","Kathy Baker","Kathy Griffin","Katrina Bowden","Keanu Reeves","Kellan Lutz","Kellie Martin","Ken Watanabe","Kerr Smith","Kevin Bacon","Kevin Connolly","Kevin Costner","Kevin McKidd","Kiefer Sutherland","Kimberlin Brown","Kimberly Matula","Kimberly McCullough","Kim Cattrall","Kim Delaney","Kim Fields","Kirstie Alley","Kit Harington","Kris Kristofferson","Kristen Alderson","Kristen Johnston","Kristian Alfonso","Kristin Chenoweth","Kristin Davis","Kristy McNichol","Lacey Chabert","Lara Flynn Boyle","Laura Innes","Lauralee Bell","Laura Leighton","Laurence Fishburne","Lauren Holly","Lauren Koslow","Laurie Metcalf","Lea Michele","Lecy Goranson","Leonardo DiCaprio","Lesley-Anne Down","Leslie Neilsen","Lexi Ainsworth","Liev Schreiber","Linda Evans","Linda Gray","Lindsay Hartley","Lisa Bonet","Lisa Kudrow","Lisa LoCicero","Loni Anderson","Lori Loughlin","Lorraine Bracco","Lourdes Benedicto","Luke Wilson","Mackenzie Aladjem","Marcia Cross","Margaret Cho","Marg Helgenberger","Mariel Hemingway","Marilu Henner","Mark Ruffalo","Mark Wahlberg","Martin Henderson","Martin Lawrence","Martin Sheen","Mary Beth Evans","Mary Crosby","Matt Czuchry","Matt Damon","Matt Dillon","Matthew Broderick","Matthew Gray Gubler","Matthew Lillard","Matthew McConaughey","Matthew Perry","Matt LeBlanc","Matt Long","Mayim Bialik","McKayla Maroney","Mel Gibson","Melina Kanakaredes","Melissa Archer","Melissa Benoist","Melissa Claire Egan","Melissa Fumero","Melissa Gilbert","Michael Douglas","Michael Landes","Michael Vartan","Michael Weatherly","Mike Myers","Mila Kunis","Milo Ventimiglia","Miranda Cosgrove","Misha Collins","Molly Burnett","Morena Baccarin","Nadia Bjorlin","Nancy Lee Grahn","Natalia Livingston","Natalie Hall","Natalie Martinez","Neal McDonough","Neve Campbell","Nick Frost","Nicolas Cage","Nicole de Boer","Nicole Eggert","Norman Reedus","Oliver Platt","Olivia d'Abo","Omid Djalili","Orlando Bloom","Owen Wilson","Pamela Anderson","Pamela Sue Martin","Patricia Arquette","Patricia Kalember","Patrick Dempsey","Patrick Swayze","Patrick Warburton","Paul Bettany","Paul Walker","Peggy Lipton","Peggy McCay","Peri Gilpin","Peter Sarsgaard","Philip Seymour Hoffman","Pierce Brosnan","Portia de Rossi","Portia Doubleday","Rachel Dratch","Rachel Griffiths","Ray Stevenson","Rebecca Budig","Rebecca Herbst","Richard E. Grant","Richard Gere","Richard Madden","Richard Schiff","Robert Di Niro","Robert Downey Jr.","Robert Duvall","Robert Knepper","Robert Patrick","Robert Pattinson","Robert Redford","Robin Williams","Rob Schneider","Roma Downey","Roseanne Barr","Rue McClanahan","Rupert Friend","Rupert Grint","Russell Crowe","Ryan Gosling","Ryan Phillippe","Ryan Reynolds","Sally Field","Sam Rockwell","Samuel L. Jackson","Sara Gilbert","Sarah Chalke","Sarah Drew","Sarah Hyland","Sarah Michelle Gellar","Sasha Alexander","Scott Patterson","Sean Bean","Selena Gomez","S. Epatha Merkerson","Seth Rogen","Shannen Doherty","Shannon Kane","Sharon Case","Sharon Gless","Shelley Hack","Shelley Hennig","Shelley Long","Sherilyn Fenn","Shia LaBeouf","Shirley Jones","Simon Pegg","Staci Keanan","Stana Katic","Steve Carell","Summer Glau","Susan Dey","Susan Flannery","Susan Lucci","Swoosie Kurtz","Tamala Jones","Tamara Braun","Tatyana M. Ali","Taylor Atelian","Taylor Lautner","Tempestt Bledsoe","Teri Hatcher","Terry Farrell","Tia Carrere","Tina Fey","Tina Louise","T.J. Thyne","Tobey Maguire","Tom Hanks","Tracey E. Bregman","Tracey Gold","Tyne Daly","Valerie Bertinelli","Valerie Cruz","Valerie Harper","Vanessa Marcil","Veronica Hamel","Victor Garber","Victoria Justice","Wanda De Jesus","Wendie Malick","Woody Allen","Yasmine Bleeth","Zooey Deschanel"},"Dimensions"->530],NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]]]],NeuralNetworks`Private`NetChain`opart,NeuralNetworks`Private`NetChain`part,NeuralNetworks`Private`NetChain`selected=Null},DynamicBox[GridBox[{{NeuralNetworks`Private`NetChain`MouseClickBoxes[TagBox[GridBox[{{TagBox[TagBox["\"\"",Annotation[#,{"Inputs","Input"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox["\"Input\"",Annotation[#,{"Inputs","Input"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TagBox[GridBox[{{"\"image\""},{TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"3\"","\"64\"","\"64\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"]}},GridBoxAlignment->{"Columns"->{{Left}}},BaselinePosition->2,DefaultBaseStyle->"Column",GridBoxItemSize->{"Columns"->{{Automatic}},"Rows"->{{Automatic}}}],"Column"],Annotation[#,{"Inputs","Input"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"1\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","1"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["ConvolutionLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","1"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"16\"","\"60\"","\"60\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","1"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"2\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","2"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["Tanh",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","2"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"16\"","\"60\"","\"60\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","2"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"3\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","3"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["PoolingLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","3"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"16\"","\"20\"","\"20\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","3"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"4\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","4"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["ConvolutionLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","4"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"32\"","\"18\"","\"18\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","4"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"5\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","5"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["Tanh",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","5"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"32\"","\"18\"","\"18\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","5"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"6\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","6"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["PoolingLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","6"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"32\"","\"6\"","\"6\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","6"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"7\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","7"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["ConvolutionLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","7"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"64\"","\"4\"","\"4\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","7"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"8\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","8"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["FlattenLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","8"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"vector\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"1024\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","8"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"9\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","9"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["LinearLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","9"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"vector\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"530\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","9"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"10\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","10"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["SoftmaxLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","10"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"vector\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"530\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","10"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox["\"\"",Annotation[#,{"Outputs","Output"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox["\"Output\"",Annotation[#,{"Outputs","Output"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox["\"class\"",Annotation[#,{"Outputs","Output"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]}},GridBoxAlignment->{"Columns"->{{Left}}},AutoDelete->False,GridBoxItemSize->{"Columns"->{{Automatic}},"Rows"->{{Automatic}}},GridBoxSpacings->{"Columns"->{{1.1}}}],"Grid"],If[ListQ[NeuralNetworks`Private`NetChain`part=MouseAnnotation[]],If[NeuralNetworks`Private`NetChain`opart===NeuralNetworks`Private`NetChain`part,NeuralNetworks`Private`NetChain`selected=Null;NeuralNetworks`Private`NetChain`opart=Null,NeuralNetworks`Private`NetChain`selected=Part[NeuralNetworks`Private`NetChain`assoc3,Apply[Sequence,NeuralNetworks`Private`NetChain`part]];NeuralNetworks`Private`NetChain`opart=NeuralNetworks`Private`NetChain`part;Null];Null]]},NeuralNetworks`Private`NetChain`fmtSelected[NeuralNetworks`Private`NetChain`selected,NeuralNetworks`Private`NetChain`part]},GridBoxSpacings->{"Columns"->{{1}}},GridBoxAlignment->{"Columns"->{{Left}}}],ImageSizeCache->{263.,{106.,111.}},TrackedSymbols:>{NeuralNetworks`Private`NetChain`selected}],Initialization:>{NetChain}],BaselinePosition->Automatic],"]"}]}],False],Deploy]


Length[training]


82954


(* ::Input:: *)
(*Export["C:\\Users\\julian\\ImageDataSets\\FaceScrub\\FaceIdentityFamous.mx",{training[[1;;80000]],training[[80001;;-1]]}];*)


trained=NetTrain[net,training[[1;;80000]],ValidationSet->training[[80001;;-1]]]


TagBox[TagBox[RowBox[{"NetChain",RowBox[{"[",PanelBox[DynamicModuleBox[{NeuralNetworks`Private`NetChain`assoc3=Association["Type"->"Chain","Nodes"->Association["1"->Association["Type"->"Convolution","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{16,3,5,5}],"Biases"->NeuralNetworks`Private`DummyRawArray[{16}]],"Parameters"->Association["OutputChannels"->16,"KernelSize"->{5,5},"Stride"->{1,1},"PaddingSize"->{0,0},"Dilation"->{1,1},"Dimensionality"->2,"InputChannels"->3,"$GroupNumber"->1,"$InputSize"->{64,64},"$OutputSize"->{60,60}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{3,64,64},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]]],"2"->Association["Type"->"Elementwise","Arrays"->Association[],"Parameters"->Association["Function"->NeuralNetworks`ValidatedParameter[Tanh],"$Dimensions"->{16,60,60}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]]],"3"->Association["Type"->"Pooling","Arrays"->Association[],"Parameters"->Association["KernelSize"->{2,2},"Stride"->{3,3},"PaddingSize"->{0,0},"Function"->Max,"Dimensionality"->2,"Channels"->16,"$InputSize"->{60,60},"$OutputSize"->{20,20},"$MXPoolingConvention"->"valid","$MXGlobalPool"->False],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{16,60,60},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{16,20,20},NeuralNetworks`RealT]]],"4"->Association["Type"->"Convolution","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{32,16,3,3}],"Biases"->NeuralNetworks`Private`DummyRawArray[{32}]],"Parameters"->Association["OutputChannels"->32,"KernelSize"->{3,3},"Stride"->{1,1},"PaddingSize"->{0,0},"Dilation"->{1,1},"Dimensionality"->2,"InputChannels"->16,"$GroupNumber"->1,"$InputSize"->{20,20},"$OutputSize"->{18,18}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{16,20,20},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]]],"5"->Association["Type"->"Elementwise","Arrays"->Association[],"Parameters"->Association["Function"->NeuralNetworks`ValidatedParameter[Tanh],"$Dimensions"->{32,18,18}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]]],"6"->Association["Type"->"Pooling","Arrays"->Association[],"Parameters"->Association["KernelSize"->{2,2},"Stride"->{3,3},"PaddingSize"->{0,0},"Function"->Max,"Dimensionality"->2,"Channels"->32,"$InputSize"->{18,18},"$OutputSize"->{6,6},"$MXPoolingConvention"->"valid","$MXGlobalPool"->False],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{32,18,18},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{32,6,6},NeuralNetworks`RealT]]],"7"->Association["Type"->"Convolution","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{64,32,3,3}],"Biases"->NeuralNetworks`Private`DummyRawArray[{64}]],"Parameters"->Association["OutputChannels"->64,"KernelSize"->{3,3},"Stride"->{1,1},"PaddingSize"->{0,0},"Dilation"->{1,1},"Dimensionality"->2,"InputChannels"->32,"$GroupNumber"->1,"$InputSize"->{6,6},"$OutputSize"->{4,4}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{32,6,6},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{64,4,4},NeuralNetworks`RealT]]],"8"->Association["Type"->"Flatten","Arrays"->Association[],"Parameters"->Association["Level"->DirectedInfinity[1],"OutputSize"->{1024},"$InputSize"->{64,4,4}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{64,4,4},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{1024},NeuralNetworks`RealT]]],"9"->Association["Type"->"Linear","Arrays"->Association["Weights"->NeuralNetworks`Private`DummyRawArray[{530,1024}],"Biases"->NeuralNetworks`Private`DummyRawArray[{530}]],"Parameters"->Association["OutputDimensions"->{530},"$OutputSize"->530,"$InputSize"->1024,"$InputDimensions"->{1024}],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{1024},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]]],"10"->Association["Type"->"Softmax","Arrays"->Association[],"Parameters"->Association[],"Inputs"->Association["Input"->NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]],"Outputs"->Association["Output"->NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]]]],"Edges"->{NeuralNetworks`NetPath["Nodes","1","Inputs","Input"]->NeuralNetworks`NetPath["Inputs","Input"],NeuralNetworks`NetPath["Nodes","2","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","1","Outputs","Output"],NeuralNetworks`NetPath["Nodes","3","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","2","Outputs","Output"],NeuralNetworks`NetPath["Nodes","4","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","3","Outputs","Output"],NeuralNetworks`NetPath["Nodes","5","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","4","Outputs","Output"],NeuralNetworks`NetPath["Nodes","6","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","5","Outputs","Output"],NeuralNetworks`NetPath["Nodes","7","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","6","Outputs","Output"],NeuralNetworks`NetPath["Nodes","8","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","7","Outputs","Output"],NeuralNetworks`NetPath["Nodes","9","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","8","Outputs","Output"],NeuralNetworks`NetPath["Nodes","10","Inputs","Input"]->NeuralNetworks`NetPath["Nodes","9","Outputs","Output"],NeuralNetworks`NetPath["Outputs","Output"]->NeuralNetworks`NetPath["Nodes","10","Outputs","Output"]},"Inputs"->Association["Input"->NetEncoder["Image",Association["ImageSize"->{64,64},"ColorSpace"->"RGB","ColorChannels"->3,"MeanImage"->None,"VarianceImage"->None],NeuralNetworks`TensorT[{3,64,64},NeuralNetworks`RealT]]],"Outputs"->Association["Output"->NetDecoder["Class",Association["Labels"->{"Aaron Eckhart","Adam Brody","Adam McKay","Adam Sandler","Adrianne Le\[OAcute]n","Adrien Brody","Adrienne Barbeau","Adrienne Frantz","Aisha Hinds","Alan Alda","Alan Arkin","Alan Rickman","Alec Baldwin","Alexander Skarsg\[ARing]rd","Alfred Molina","Alice Krige","Alley Mills","Allison Janney","Al Pacino","Alyson Hannigan","Alyssa Milano","Amanda Bearse","Amaury Nolasco","America Ferrera","Amy Davidson","Andrea Anders","Andrea Bogart","Andrea Bowen","Andy Garcia","Andy Richter","Andy Serkis","Angell Conwell","Angie Harmon","Anne Hathaway","Annie Ilonzeh","Anthony Hopkins","Anthony Stewart Head","Antonio Banderas","Arnold Schwarzenegger","Arnold Vosloo","Ashley Benson","Ashley Johnson","Ashley Jones","Ashton Kutcher","Audra McDonald","Audrey Landers","Barbara Carrera","Ben Affleck","Benicio Del Toro","Ben Kingsley","Ben McKenzie","Ben Stiller","Bernard Hill","Bernie Mac","Bill Cosby","Bill Hader","Bill Murray","Bill Nighy","Billy Bob Thornton","Billy Boyd","Billy Burke","Billy Zane","Bobbie Eakes","Bonnie Franklin","Brad Garrett","Bradley Cooper","Brad Pitt","Brendan Fraser","Brianna Brown","Brooke Langton","Bruce Greenwood","Bruce Willis","Burt Reynolds","Calista Flockhart","Cam Gigandet","Candace Cameron Bure","Candice Bergen","Carey Lowell","Carla Gallo","Carmen Electra","Caroline Dhavernas","Carolyn Hennesy","Cary Elwes","Casey Affleck","Catherine Bell","Cathy Lee Crosby","Channing Tatum","Charlie Day","Charlie Sheen","Chase Masterson","Chazz Palminteri","Cheryl Hines","Cheryl Ladd","Chris Evans","Chris Kattan","Chris Klein","Chris Noth","Chris Rock","Christa Miller","Christel Khalil","Christian Bale","Christian Slater","Christina Applegate","Christina Bennett Lind","Christine Lakin","Christopher Lloyd","Christopher Reeve","Chyler Leigh","Ciara Bravo","Clint Eastwood","Clive Owen","Colin Farrell","Colin Firth","Colin Hanks","Courteney Cox","Crystal Bernard","Crystal Chappell","Dana Delany","Danica McKellar","Daniel Craig","Daniel Day-Lewis","Daniel Radcliffe","Dan Lauria","Danny Glover","Danny Masterson","Danny Trejo","David Boreanaz","David Cross","David Duchovny","David Schwimmer","David Wenham","Dean Cain","Debi Mazar","Debra Messing","Delta Burke","Denise Crosby","Denzel Washington","Dermot Mulroney","Desmond Harrington","Diahann Carroll","Dianna Agron","Didi Conn","Diego Luna","Dina Meyer","Dominic Monaghan","Don Cheadle","Drea de Matteo","Dustin Hoffman","Dwayne Johnson","Ed Harris","Edie Falco","Edi Gathegi","Eileen Davidson","Elijah Wood","Elizabeth Berkley","Elizabeth Hendrickson","Eliza Coupe","Eliza Dushku","Ellen DeGeneres","Ellen Greene","Emile Hirsch","Emily Deschanel","Eric Dane","Erin Chambers","Erin Cummings","Ethan Hawke","Eva Longoria","Ewan McGregor","Faith Ford","Farah Fath","Farrah Fawcett","Felicity Huffman","Florencia Lozano","Frances Fisher","Fran Drescher","Freddy Prinze Jr.","Freddy Rodr\[IAcute]guez","Gabrielle Carteris","Gabriel Macht","Gary Dourdan","Gary Oldman","Gates McFadden","Geena Davis","Gene Hackman","Geoffrey Rush","George Clooney","George Lopez","Gerard Butler","Gillian Anderson","Giovanni Ribisi","Glenn Close","Hal Holbrook","Hank Azaria","Harrison Ford","Harry Connick Jr.","Hayden Christensen","Heather Locklear","Heath Ledger","Hector Elizondo","Helen Hunt","Holly Marie Combs","Hugh Grant","Hugh Jackman","Hugo Weaving","Ian Holm","Ian McKellen","Ilene Kristen","Ioan Gruffudd","Jackee Harry","Jackie Chan","Jack Nicholson","Jackson Rathbone","Jaden Smith","Jake Gyllenhaal","Jake Weber","James Brolin","James Frain","James Franco","James Marsden","James McAvoy","James Remar","Jamie Foxx","Jamie Lee Curtis","Jamie Luner","Jane Curtin","Jane Krakowski","Jane Leeves","Jane Lynch","January Jones","Jared Padalecki","Jasmine Guy","Jason Bateman","Jason Behr","Jason Biggs","Jason Lee","Jason Statham","Jason Sudeikis","Jay Baruchel","Jean-Claude Van Damme","Jeanne Cooper","Jean Reno","Jeffrey Tambor","Jenilee Harrison","Jennette McCurdy","Jennie Garth","Jennifer Aniston","Jennifer Gareis","Jennifer Love Hewitt","Jensen Ackles","Jeremy Irons","Jeremy Sisto","Jerry Seinfeld","Jesse Eisenberg","Jessica Biel","Jessica Capshaw","Jessica Leccia","Jet Li","Jill Eikenberry","Jill Hennessy","Jim Beaver","Jim Carrey","Jim Caviezel","Jimmy Fallon","J.K. Simmons","Joan Collins","Joanna Garc\[IAcute]a","Joanna Kerns","Joaquin Phoenix","Jodi Long","Joe Manganiello","Joe Pantoliano","John Cleese","John Cusack","John Krasinski","John Malkovich","John Noble","Johnny Depp","John Travolta","Jolene Blalock","Jonah Hill","Jonathan Rhys Meyers","Jonathan Sadowski","Jon Hamm","Jon Voight","Josh Brolin","Josh Duhamel","Josh Hartnett","Joshua Jackson","Josie Bissett","Joyce DeWitt","Jude Law","Judi Evans","Judith Light","Julia Louis-Dreyfus","Julianna Margulies","Julie Benz","Julie Bowen","Julie Marie Berman","Justine Bateman","Justin Long","Justin Timberlake","Kaley Cuoco","Kal Penn","Karl Urban","Kassie DePaiva","Kate Linder","Katherine Helmond","Katherine Kelly Lang","Kathryn Joosten","Kathy Baker","Kathy Griffin","Katrina Bowden","Keanu Reeves","Kellan Lutz","Kellie Martin","Ken Watanabe","Kerr Smith","Kevin Bacon","Kevin Connolly","Kevin Costner","Kevin McKidd","Kiefer Sutherland","Kimberlin Brown","Kimberly Matula","Kimberly McCullough","Kim Cattrall","Kim Delaney","Kim Fields","Kirstie Alley","Kit Harington","Kris Kristofferson","Kristen Alderson","Kristen Johnston","Kristian Alfonso","Kristin Chenoweth","Kristin Davis","Kristy McNichol","Lacey Chabert","Lara Flynn Boyle","Laura Innes","Lauralee Bell","Laura Leighton","Laurence Fishburne","Lauren Holly","Lauren Koslow","Laurie Metcalf","Lea Michele","Lecy Goranson","Leonardo DiCaprio","Lesley-Anne Down","Leslie Neilsen","Lexi Ainsworth","Liev Schreiber","Linda Evans","Linda Gray","Lindsay Hartley","Lisa Bonet","Lisa Kudrow","Lisa LoCicero","Loni Anderson","Lori Loughlin","Lorraine Bracco","Lourdes Benedicto","Luke Wilson","Mackenzie Aladjem","Marcia Cross","Margaret Cho","Marg Helgenberger","Mariel Hemingway","Marilu Henner","Mark Ruffalo","Mark Wahlberg","Martin Henderson","Martin Lawrence","Martin Sheen","Mary Beth Evans","Mary Crosby","Matt Czuchry","Matt Damon","Matt Dillon","Matthew Broderick","Matthew Gray Gubler","Matthew Lillard","Matthew McConaughey","Matthew Perry","Matt LeBlanc","Matt Long","Mayim Bialik","McKayla Maroney","Mel Gibson","Melina Kanakaredes","Melissa Archer","Melissa Benoist","Melissa Claire Egan","Melissa Fumero","Melissa Gilbert","Michael Douglas","Michael Landes","Michael Vartan","Michael Weatherly","Mike Myers","Mila Kunis","Milo Ventimiglia","Miranda Cosgrove","Misha Collins","Molly Burnett","Morena Baccarin","Nadia Bjorlin","Nancy Lee Grahn","Natalia Livingston","Natalie Hall","Natalie Martinez","Neal McDonough","Neve Campbell","Nick Frost","Nicolas Cage","Nicole de Boer","Nicole Eggert","Norman Reedus","Oliver Platt","Olivia d'Abo","Omid Djalili","Orlando Bloom","Owen Wilson","Pamela Anderson","Pamela Sue Martin","Patricia Arquette","Patricia Kalember","Patrick Dempsey","Patrick Swayze","Patrick Warburton","Paul Bettany","Paul Walker","Peggy Lipton","Peggy McCay","Peri Gilpin","Peter Sarsgaard","Philip Seymour Hoffman","Pierce Brosnan","Portia de Rossi","Portia Doubleday","Rachel Dratch","Rachel Griffiths","Ray Stevenson","Rebecca Budig","Rebecca Herbst","Richard E. Grant","Richard Gere","Richard Madden","Richard Schiff","Robert Di Niro","Robert Downey Jr.","Robert Duvall","Robert Knepper","Robert Patrick","Robert Pattinson","Robert Redford","Robin Williams","Rob Schneider","Roma Downey","Roseanne Barr","Rue McClanahan","Rupert Friend","Rupert Grint","Russell Crowe","Ryan Gosling","Ryan Phillippe","Ryan Reynolds","Sally Field","Sam Rockwell","Samuel L. Jackson","Sara Gilbert","Sarah Chalke","Sarah Drew","Sarah Hyland","Sarah Michelle Gellar","Sasha Alexander","Scott Patterson","Sean Bean","Selena Gomez","S. Epatha Merkerson","Seth Rogen","Shannen Doherty","Shannon Kane","Sharon Case","Sharon Gless","Shelley Hack","Shelley Hennig","Shelley Long","Sherilyn Fenn","Shia LaBeouf","Shirley Jones","Simon Pegg","Staci Keanan","Stana Katic","Steve Carell","Summer Glau","Susan Dey","Susan Flannery","Susan Lucci","Swoosie Kurtz","Tamala Jones","Tamara Braun","Tatyana M. Ali","Taylor Atelian","Taylor Lautner","Tempestt Bledsoe","Teri Hatcher","Terry Farrell","Tia Carrere","Tina Fey","Tina Louise","T.J. Thyne","Tobey Maguire","Tom Hanks","Tracey E. Bregman","Tracey Gold","Tyne Daly","Valerie Bertinelli","Valerie Cruz","Valerie Harper","Vanessa Marcil","Veronica Hamel","Victor Garber","Victoria Justice","Wanda De Jesus","Wendie Malick","Woody Allen","Yasmine Bleeth","Zooey Deschanel"},"Dimensions"->530],NeuralNetworks`TensorT[{530},NeuralNetworks`RealT]]]],NeuralNetworks`Private`NetChain`opart,NeuralNetworks`Private`NetChain`part,NeuralNetworks`Private`NetChain`selected=Null},DynamicBox[GridBox[{{NeuralNetworks`Private`NetChain`MouseClickBoxes[TagBox[GridBox[{{TagBox[TagBox["\"\"",Annotation[#,{"Inputs","Input"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox["\"Input\"",Annotation[#,{"Inputs","Input"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TagBox[GridBox[{{"\"image\""},{TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"3\"","\"64\"","\"64\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"]}},GridBoxAlignment->{"Columns"->{{Left}}},BaselinePosition->2,DefaultBaseStyle->"Column",GridBoxItemSize->{"Columns"->{{Automatic}},"Rows"->{{Automatic}}}],"Column"],Annotation[#,{"Inputs","Input"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"1\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","1"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["ConvolutionLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","1"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"16\"","\"60\"","\"60\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","1"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"2\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","2"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["Tanh",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","2"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"16\"","\"60\"","\"60\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","2"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"3\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","3"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["PoolingLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","3"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"16\"","\"20\"","\"20\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","3"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"4\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","4"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["ConvolutionLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","4"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"32\"","\"18\"","\"18\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","4"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"5\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","5"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["Tanh",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","5"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"32\"","\"18\"","\"18\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","5"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"6\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","6"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["PoolingLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","6"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"32\"","\"6\"","\"6\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","6"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"7\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","7"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["ConvolutionLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","7"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"3-tensor\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"64\"","\"4\"","\"4\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","7"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"8\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","8"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["FlattenLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","8"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"vector\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"1024\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","8"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"9\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","9"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["LinearLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","9"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"vector\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"530\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","9"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox[StyleBox["\"10\"",GrayLevel[0.5],StripOnInput->False],Annotation[#,{"Nodes","10"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[StyleBox["SoftmaxLayer",GrayLevel[0],StripOnInput->False],Annotation[#,{"Nodes","10"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox[TemplateBox[{"\"vector\"","\" \"",StyleBox[TemplateBox[{"\"(\"","\" \"","\"size\"","\":\"","\" \"",TemplateBox[{"*","\"*\"","\"530\""},"RowWithSeparators"],"\" \"","\")\""},"RowDefault"],GrayLevel[0.5],StripOnInput->False]},"RowDefault"],Annotation[#,{"Nodes","10"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]},{TagBox[TagBox["\"\"",Annotation[#,{"Outputs","Output"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox["\"Output\"",Annotation[#,{"Outputs","Output"},"Mouse"]&],MouseAppearanceTag["LinkHand"]],TagBox[TagBox["\"class\"",Annotation[#,{"Outputs","Output"},"Mouse"]&],MouseAppearanceTag["LinkHand"]]}},GridBoxAlignment->{"Columns"->{{Left}}},AutoDelete->False,GridBoxItemSize->{"Columns"->{{Automatic}},"Rows"->{{Automatic}}},GridBoxSpacings->{"Columns"->{{1.1}}}],"Grid"],If[ListQ[NeuralNetworks`Private`NetChain`part=MouseAnnotation[]],If[NeuralNetworks`Private`NetChain`opart===NeuralNetworks`Private`NetChain`part,NeuralNetworks`Private`NetChain`selected=Null;NeuralNetworks`Private`NetChain`opart=Null,NeuralNetworks`Private`NetChain`selected=Part[NeuralNetworks`Private`NetChain`assoc3,Apply[Sequence,NeuralNetworks`Private`NetChain`part]];NeuralNetworks`Private`NetChain`opart=NeuralNetworks`Private`NetChain`part;Null];Null]]},NeuralNetworks`Private`NetChain`fmtSelected[NeuralNetworks`Private`NetChain`selected,NeuralNetworks`Private`NetChain`part]},GridBoxSpacings->{"Columns"->{{1}}},GridBoxAlignment->{"Columns"->{{Left}}}],ImageSizeCache->{263.,{106.,111.}},TrackedSymbols:>{NeuralNetworks`Private`NetChain`selected}],Initialization:>{NetChain}],BaselinePosition->Automatic],"]"}]}],False],Deploy]


(* Validation results = 1.8, 1.54, 1.76 *)


(* Achieves around 70% Top 1 and 83% Top 5.
   Sadly this may be misleading as exist some near duplicates, eg slightly different size
   possibly colour processing etc *)


(* ::Input:: *)
(*Export["C:\\Users\\julian\\CZModels\\FaceScrubFaceRecognitionv1.wlnet",trained];*)


toRule[{img1_->l1_,img2_->l2_}]:={img1,img2}->l1!=l2;


actors=GroupBy[dataset,#[[2]]&];


rndactors=RandomSample[actors];


(* ::Input:: *)
(*Export["C:\\Users\\julian\\ImageDataSets\\FaceScrub\\FaceMetricActors.mx",{rndactors[[1;;500]],rndactors[[501;;-1]]}];*)


RandomPair[act_] := ( a=RandomInteger[{1,Length[act]}];
If[Random[]>.5,b=a,b=RandomInteger[{1,Length[act]}]];
{RandomChoice[act[[a]]],RandomChoice[act[[b]]]})


trainingData=Table[toRule@RandomPair[rndactors[[1;;500]]],300000];


validationData=Table[toRule@RandomPair[actors[[501;;-1]]],5000];


embnet=NetPairEmbeddingOperator[NetChain[{Take[trained,8],16}]]


embtrained=NetTrain[embnet,trainingData,ValidationSet->validationData]


(* ::Input:: *)
(*.22,.21*)


(* ::Input:: *)
(*Export["C:\\Users\\julian\\CZModels\\FaceScrubFaceRecognitionMetricv1.wlnet",embtrained];*)


(* Results about 50% accurate on database with 10 people
   adding more pictures/person makes little difference *)
